# Installation
# pip install bert-extractive-summarizer


import transformers
import torch
torch.cuda.set_device(torch.device('cuda:0'))
torch.cuda.empty_cache()
from transformers import BitsAndBytesConfig, AutoModelForCausalLM, AutoTokenizer
import torch
import sys
import re
from summarizer import Summarizer
from transformers import pipeline


HF_TOKEN = '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' # to be replaced by a hugging face token
extractive_model = Summarizer()

text = """Résume ce texte en français:
texte:12.7.2019\nFR\nJournal officiel de l'Union européenne\nL 188/55\nRÈGLEMENT (UE) 2019/1156 DU PARLEMENT EUROPÉEN ET DU CONSEIL\ndu 20 juin 2019\nvisant à faciliter la distribution transfrontalière des organismes de placement collectif et modifiant les règlements (UE) no 345/2013, (UE) no 346/2013 et (UE) no 1286/2014\n(Texte présentant de l'intérêt pour l'EEE)\nLE PARLEMENT EUROPÉEN ET LE CONSEIL DE L'UNION EUROPÉENNE,\nvu le traité sur le fonctionnement de l'Union européenne, et notamment son article 114,\nvu la proposition de la Commission européenne,\naprès transmission du projet d'acte législatif aux parlements nationaux,\nvu l'avis du Comité économique et social européen (1),\nstatuant conformément à la procédure législative ordinaire (2),\nconsidérant ce qui suit:\n(1)\nLa divergence des approches réglementaires et de surveillance concernant la distribution transfrontalière des fonds d'investissement alternatifs (FIA), au sens de la directive 2011/61/UE du Parlement européen et du Conseil (3), y compris les fonds de capital-risque européens (EuVECA) au sens du règlement (UE) no 345/2013 du Parlement européen et du Conseil (4), les fonds d'entrepreneuriat social européens (EuSEF) au sens du règlement (UE) no 346/2013 du Parlement européen et du Conseil (5), les fonds européens d'investissement à long terme (ELTIF) au sens du règlement (UE) no 2015/760 du Parlement européen et du Conseil (6), ainsi que les organismes de placement collectif en valeurs mobilières (OPCVM) au sens de la directive 2009/65/CE du Parlement européen et du Conseil (7), a pour effet de fragmenter le marché et d'entraver la commercialisation transfrontalière et l'accès des FIA et des OPCVM, ce qui pourrait les empêcher d'être commercialisés dans d'autres États membres. Un OPCVM pourrait faire l'objet d'une gestion externe ou interne, en fonction de sa forme juridique. Toute disposition du présent règlement relative aux sociétés de gestion d'OPCVM devrait s'appliquer aussi bien à une société dont l'activité habituelle est la gestion d'OPCVM qu'à tout OPCVM qui n'a pas désigné de société de gestion d'OPCVM.\n(2)\nAfin de renforcer le cadre réglementaire applicable aux organismes de placement collectif et d'améliorer la protection des investisseurs, il convient que les communications publicitaires destinées aux investisseurs de FIA et d'OPCVM soient identifiables en tant que telles et décrivent de manière identique les risques et les avantages inhérents à l'achat de parts ou d'actions de FIA ou d'OPCVM. En outre, toutes les informations y figurant adressées aux investisseurs devraient être présentées d'une manière correcte, claire et non trompeuse. Afin de garantir la protection des investisseurs et l'égalité des conditions de concurrence entre FIA et OPCVM, les normes en matière de communication publicitaire devraient s'appliquer aux uns et aux autres.\n(3)\nLes communications publicitaires adressées aux investisseurs de FIA et d'OPCVM devraient préciser où, comment et en quelle langue les investisseurs peuvent obtenir un résumé des informations concernant les droits des investisseurs, et indiquer clairement que le gestionnaire de FIA, d'EuVECA, d'EUSEF ou la société de gestion d'OPCVM (ci-après dénommés ensemble «gestionnaires d'organismes de placement collectif») a le droit de mettre un terme à la commercialisation.\n(4)\nPour accroître la transparence et la protection des investisseurs et pour faciliter l'accès aux informations sur les lois, réglementations et dispositions administratives nationales applicables aux communications publicitaires, les autorités compétentes devraient les publier sur leur site internet, dans au minimum une langue communément utilisée dans la sphère financière internationale, avec leur résumé non officiel, ce qui permettrait aux gestionnaires d'organismes de placement collectif d'obtenir un aperçu général de ces lois, réglementations et dispositions administratives. La publication ne devrait avoir lieu qu'à des fins d'information et ne devrait pas créer d'obligations juridiques. Pour les mêmes motifs, l'autorité européenne de surveillance (AEMF – Autorité européenne des marchés financiers établie par le règlement UE no 1095/2010 du Parlement européen et du Conseil (8)) devrait créer une base de données centrale contenant les résumés des exigences nationales applicables aux communications publicitaires et des hyperliens menant aux informations publiées sur les sites internet des autorités compétentes.\n(5)\nAfin de promouvoir les bonnes pratiques de protection des investisseurs qui sont inscrites dans les exigences nationales en matière de communications publicitaires équitables et claires, y compris pour les aspects de ces communications publicitaires disponibles sur internet, l'AEMF devrait fixer des orientations concernant l'application de ces exigences aux communications publicitaires.\n(6)\nLes autorités compétentes devraient pouvoir imposer la notification préalable des communications publicitaires en vue de vérifier ex-ante la conformité de celles-ci avec les dispositions du présent règlement et les autres exigences applicables, notamment si les communications publicitaires sont identifiables en tant que telles, si elles décrivent les risques et les avantages inhérents à l'achat de parts d'un OPCVM et, lorsqu'un État membre autorise la commercialisation de FIA aux investisseurs de détail, et les risques et les avantages inhérents à l'achat de parts ou d'actions d'un FIA de manière identique et de vérifier de manière identique si toutes les informations figurant dans les communications publicitaires sont présentées de façon correcte, claire et non trompeuse. Cette vérification devrait avoir lieu dans un délai limité. Lorsque les autorités compétentes exigent une notification préalable, cela ne devrait pas les empêcher de vérifier les communications publicitaires a posteriori.\n(7)\nLes autorités compétentes devraient communiquer à l'AEMF les résultats de ces vérifications, les demandes de modifications et toute sanction imposée aux gestionnaires d'organismes de placement collectif. Pour mieux faire connaître les règles applicables aux communications publicitaires, d'une part, et en accroître la transparence, d'autre part, tout en protégeant les investisseurs, l'AEMF devrait élaborer, tous les deux ans, un rapport basé sur des vérifications des communications publicitaires effectuées ex ante et ex post par les autorités compétentes pour rendre compte de l'application pratique de ces règles, et transmettre ce rapport au Parlement européen, au Conseil et à la Commission.\n(8)\nAfin de garantir l'égalité de traitement des gestionnaires d'organismes de placement collectif et de les aider à prendre la décision de s'engager ou non dans la distribution transfrontalière de fonds d'investissement, il importe que les frais et charges perçus par les autorités compétentes en contrepartie de la surveillance des activités transfrontalières soient proportionnés aux tâches de surveillance accomplies et soient rendus publics, et que, dans un souci de transparence, ces frais et charges soient publiés sur les sites internet desdites autorités. Pour la même raison, l'AEMF devrait mettre à disposition sur son site internet les hyperliens menant aux informations publiées sur les sites internet des autorités compétentes en ce qui concerne les frais et charges afin que les informations soient centralisées en un seul point.
"""

# Optional approach to extract relevant sentences in order to reduce the size of the text to match with the context window 
extractive_summary = extractive_model(text)

abstractive_model = pipeline('summarization', model = 'MikaSie/RoBERTa_BART_dependent_V1', tokenizer =  'MikaSie/RoBERTa_BART_dependent_V1', token = HF_TOKEN)

result = abstractive_model(extractive_summary)
print(result)
